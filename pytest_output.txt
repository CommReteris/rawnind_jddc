============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0 -- /home/rengo/rawnind_jddc/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/rengo/rawnind_jddc
configfile: pyproject.toml
plugins: cov-7.0.0
collecting ... collected 465 items

src/rawnind/dataset/tests/test_anti_patterns.py::test_critical_classes_are_singletons FAILED [  0%]
src/rawnind/dataset/tests/test_configurable_dataset.py::test_configurable_dataset_initialization PASSED [  0%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_valid_minimal PASSED [  0%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_valid_bayer PASSED [  0%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_crop_size[0] PASSED [  1%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_crop_size[-1] PASSED [  1%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_crop_size[7] PASSED [  1%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_crop_size[9] PASSED [  1%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_num_crops_per_image[0] PASSED [  1%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_num_crops_per_image[-1] PASSED [  2%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_batch_size[0] PASSED [  2%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_batch_size[-1] PASSED [  2%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_input_channels[0] PASSED [  2%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_input_channels[-1] PASSED [  3%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_output_channels[0] PASSED [  3%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_invalid_output_channels[-1] PASSED [  3%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_bayer_rgb_channel_mismatch PASSED [  3%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_rgb_bayer_channel_mismatch PASSED [  3%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_quality_thresholds_default FAILED [  4%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_quality_thresholds_custom FAILED [  4%]
src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_other_fields_preserved PASSED [  4%]
src/rawnind/dataset/tests/test_datasets_load_time.py::test_measure_train_images_load_time ERROR [  4%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_shapes[clean-bayer-BayerDatasetConfig-mock_content_fpath_rawnind-extra_params0-expected_x_shape0-expected_y_shape0] PASSED [  4%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_shapes[clean-rgb-RgbDatasetConfig-mock_content_fpath_extraraw-extra_params1-expected_x_shape1-expected_y_shape1] PASSED [  5%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_shapes[noisy-bayer-BayerDatasetConfig-mock_content_fpath_rawnind-extra_params2-expected_x_shape2-expected_y_shape2] PASSED [  5%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_shapes[noisy-rgb-RgbDatasetConfig-mock_content_fpath_extraraw-extra_params3-expected_x_shape3-expected_y_shape3] PASSED [  5%]
src/rawnind/dataset/tests/test_integration.py::test_rawimagedataset_random_crops[128-4-True-expected_x_shape0-expected_y_shape0-expected_mask_shape0] PASSED [  5%]
src/rawnind/dataset/tests/test_integration.py::test_rawimagedataset_random_crops[128-4-False-expected_x_shape1-None-expected_mask_shape1] PASSED [  6%]
src/rawnind/dataset/tests/test_integration.py::test_rawimagedataset_random_crops[256-2-True-expected_x_shape2-expected_y_shape2-expected_mask_shape2] PASSED [  6%]
src/rawnind/dataset/tests/test_integration.py::test_rawimagedataset_center_crop[128-True-True-expected_x_shape0-expected_y_shape0-expected_mask_shape0] PASSED [  6%]
src/rawnind/dataset/tests/test_integration.py::test_rawimagedataset_center_crop[128-True-False-expected_x_shape1-expected_y_shape1-expected_mask_shape1] PASSED [  6%]
src/rawnind/dataset/tests/test_integration.py::test_rawimagedataset_center_crop[256-False-True-expected_x_shape2-None-expected_mask_shape2] PASSED [  6%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_gain[noisy-bayer-BayerDatasetConfig-mock_content_fpath_rawnind-extra_params0-1.5] PASSED [  7%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_gain[noisy-rgb-RgbDatasetConfig-mock_content_fpath_extraraw-extra_params1-1.0] PASSED [  7%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_gain[clean-bayer-BayerDatasetConfig-mock_content_fpath_rawnind-extra_params2-1.0] PASSED [  7%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_msssim_filter[0.0-1.0-2] PASSED [  7%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_msssim_filter[0.9-1.0-1] PASSED [  7%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_msssim_filter[0.96-1.0-0] FAILED [  8%]
src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_no_images PASSED [  8%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-bayer-basic] SKIPPED [  8%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-prgb-basic] SKIPPED [  8%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-proc-basic] SKIPPED [  9%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-bayer-basic] SKIPPED [  9%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-prgb-basic] SKIPPED [  9%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-proc-basic] SKIPPED [  9%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-bayer-ext_raw] SKIPPED [  9%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-prgb-ext_raw] SKIPPED [ 10%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-bayer-ext_raw] SKIPPED [ 10%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-prgb-ext_raw] SKIPPED [ 10%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-bayer-progressive] SKIPPED_0.99_msssim_loss for 0.99) [ 10%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[dc-prgb-progressive] SKIPPED_0.99_msssim_loss for 0.99) [ 10%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-bayer-progressive] SKIPPEDim_le_0.99_msssim_loss for 0.99) [ 11%]
src/rawnind/dataset/tests/test_manproc.py::test_manproc[denoise-prgb-progressive] SKIPPEDim_le_0.99_msssim_loss for 0.99) [ 11%]
src/rawnind/dataset/tests/test_validation.py::test_get_ds_avg_msssim PASSED [ 11%]
src/rawnind/dataset/tests/test_validation.py::test_check_whether_wb_is_needed_before_demosaic PASSED [ 11%]
src/rawnind/dataset/tests/test_validation.py::test_get_models_complexity PASSED [ 12%]
src/rawnind/dependencies/tests/test_config_manager.py::test_load_config PASSED [ 12%]
src/rawnind/dependencies/tests/test_config_manager.py::test_load_config_nonexistent_file PASSED [ 12%]
src/rawnind/dependencies/tests/test_config_manager.py::test_get_training_config PASSED [ 12%]
src/rawnind/dependencies/tests/test_config_manager.py::test_get_test_config PASSED [ 12%]
src/rawnind/dependencies/tests/test_config_manager.py::test_get_model_config PASSED [ 13%]
src/rawnind/dependencies/tests/test_config_manager.py::test_save_config PASSED [ 13%]
src/rawnind/dependencies/tests/test_config_manager.py::test_merge_configs PASSED [ 13%]
src/rawnind/dependencies/tests/test_config_manager.py::test_merge_configs_deep_nesting PASSED [ 13%]
src/rawnind/dependencies/tests/test_config_manager.py::test_merge_configs_non_dict_override PASSED [ 13%]
src/rawnind/dependencies/tests/test_file_io.py::test_hdr_nparray_to_file_integration PASSED [ 14%]
src/rawnind/dependencies/tests/test_file_io.py::test_file_io_integration_exr_save[lin_rec2020-16-.exr] PASSED [ 14%]
src/rawnind/dependencies/tests/test_file_io.py::test_file_io_integration_exr_save[lin_sRGB-32-.exr] PASSED [ 14%]
src/rawnind/dependencies/tests/test_file_io.py::test_file_io_integration_tiff_save[lin_rec2020-16-.tif] PASSED [ 14%]
src/rawnind/dependencies/tests/test_file_io.py::test_file_io_integration_tiff_save[gamma_sRGB-None-.tif] PASSED [ 15%]
src/rawnind/dependencies/tests/test_file_io.py::TestXTransProcessing::test_is_xtrans_true PASSED [ 15%]
src/rawnind/dependencies/tests/test_file_io.py::TestXTransProcessing::test_is_xtrans_false PASSED [ 15%]
src/rawnind/dependencies/tests/test_file_io.py::TestXTransProcessing::test_xtrans_fpath_to_openexr_success PASSED [ 15%]
src/rawnind/dependencies/tests/test_file_io.py::TestXTransProcessing::test_xtrans_fpath_to_openexr_darktable_not_found PASSED [ 15%]
src/rawnind/dependencies/tests/test_file_io.py::TestXTransProcessing::test_xtrans_fpath_to_openexr_non_raf_input PASSED [ 16%]
src/rawnind/dependencies/tests/test_file_io.py::TestRawFpathtoHdrImgFile::test_raw_fpath_to_hdr_img_file_ok_outcome PASSED [ 16%]
src/rawnind/dependencies/tests/test_file_io.py::TestRawFpathtoHdrImgFile::test_raw_fpath_to_hdr_img_file_bad_exposure_outcome PASSED [ 16%]
src/rawnind/dependencies/tests/test_file_io.py::TestRawFpathtoHdrImgFile::test_raw_fpath_to_hdr_img_file_unreadable_error_outcome PASSED [ 16%]
src/rawnind/dependencies/tests/test_file_io.py::TestRawFpathtoHdrImgFile::test_raw_fpath_to_hdr_img_file_unknown_error_outcome PASSED [ 16%]
src/rawnind/dependencies/tests/test_file_io.py::TestRawFpathtoHdrImgFile::test_raw_fpath_to_hdr_img_file_hdr_save_error PASSED [ 17%]
src/rawnind/dependencies/tests/test_json_saver.py::test_load_yaml_file_exists PASSED [ 17%]
src/rawnind/dependencies/tests/test_json_saver.py::test_load_yaml_file_not_found_error PASSED [ 17%]
src/rawnind/dependencies/tests/test_json_saver.py::test_load_yaml_file_not_found_no_error PASSED [ 17%]
src/rawnind/dependencies/tests/test_json_saver.py::test_dict_to_yaml_creates_directory PASSED [ 18%]
src/rawnind/dependencies/tests/test_json_saver.py::test_dict_to_json_basic PASSED [ 18%]
src/rawnind/dependencies/tests/test_json_saver.py::test_jsonfpath_load_file_exists PASSED [ 18%]
src/rawnind/dependencies/tests/test_json_saver.py::test_jsonfpath_load_file_not_found PASSED [ 18%]
src/rawnind/dependencies/tests/test_json_saver.py::test_jsonfpath_load_file_not_found_no_default PASSED [ 18%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_init_basic PASSED [ 19%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_init_with_epoch_type PASSED [ 19%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_init_with_custom_default PASSED [ 19%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_init_directory_path_raises_error PASSED [ 19%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_basic_minimize PASSED [ 20%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_maximize_metric PASSED [ 20%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_mixed_minimize_dict PASSED [ 20%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_with_warmup PASSED [ 20%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_with_key_prefix PASSED [ 20%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_skips_none_values PASSED [ 21%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_with_epoch_parameter PASSED [ 21%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_add_res_missing_step_epoch_raises_error PASSED [ 21%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_get_best_step PASSED [ 21%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_get_best_step_missing_metric_raises_error PASSED [ 21%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_get_best_step_results PASSED [ 22%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_get_best_steps PASSED [ 22%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_is_empty PASSED [ 22%]
src/rawnind/dependencies/tests/test_json_saver.py::TestJSONSaver::test_write_saves_to_file PASSED [ 22%]
src/rawnind/dependencies/tests/test_json_saver.py::TestYAMLSaver::test_init_inherits_from_json_saver PASSED [ 23%]
src/rawnind/dependencies/tests/test_json_saver.py::TestYAMLSaver::test_write_saves_to_yaml_file PASSED [ 23%]
src/rawnind/dependencies/tests/test_json_saver.py::TestYAMLSaver::test_load_existing_yaml_file PASSED [ 23%]
src/rawnind/dependencies/tests/test_json_saver.py::TestYAMLSaver::test_load_nonexistent_yaml_file_uses_default PASSED [ 23%]
src/rawnind/dependencies/tests/test_locking.py::test_lock_unlock_basic_cpu PASSED [ 23%]
src/rawnind/dependencies/tests/test_locking.py::test_lock_unlock_basic_gpu PASSED [ 24%]
src/rawnind/dependencies/tests/test_locking.py::test_is_locked_not_locked PASSED [ 24%]
src/rawnind/dependencies/tests/test_locking.py::test_is_locked_own_lock PASSED [ 24%]
src/rawnind/dependencies/tests/test_locking.py::test_is_locked_other_process PASSED [ 24%]
src/rawnind/dependencies/tests/test_locking.py::test_is_locked_stale_lock PASSED [ 24%]
src/rawnind/dependencies/tests/test_locking.py::test_is_owned_owns_lock PASSED [ 25%]
src/rawnind/dependencies/tests/test_locking.py::test_is_owned_does_not_own PASSED [ 25%]
src/rawnind/dependencies/tests/test_locking.py::test_unlock_not_owned PASSED [ 25%]
src/rawnind/dependencies/tests/test_locking.py::test_check_pause_no_pause_files PASSED [ 25%]
src/rawnind/dependencies/tests/test_locking.py::test_check_pause_process_specific PASSED [ 26%]
src/rawnind/dependencies/tests/test_locking.py::test_check_pause_global PASSED [ 26%]
src/rawnind/dependencies/tests/test_locking.py::test_lock_backoff_and_acquire PASSED [ 26%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_img_fpath_to_np_flt_file_not_found PASSED [ 26%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_img_fpath_to_np_flt_raw_loading PASSED [ 26%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_img_fpath_to_np_flt_opencv_backend PASSED [ 27%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_pad_img_pair_even PASSED [ 27%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_pad_img_pair_odd PASSED [ 27%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_crop_img_pair_center PASSED [ 27%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_crop_img_pair_rand PASSED [ 27%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_crop_img_pair_full_size PASSED [ 28%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_to_img_png_16bit PASSED [ 28%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_to_img_png_8bit PASSED [ 28%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_to_img_single_channel PASSED [ 28%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_to_img_not_implemented_precision PASSED [ 29%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_l1_avg PASSED [ 29%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_np_l1_element_wise PASSED [ 29%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_gamma_np_positive_values PASSED [ 29%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_gamma_np_non_positive_values PASSED [ 29%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_gamma_np_in_place PASSED [ 30%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_scenelin_to_pq_and_back_np PASSED [ 30%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_match_gain_numpy_implementation PASSED [ 30%]
src/rawnind/dependencies/tests/test_numpy_operations.py::test_match_gain_division_by_zero PASSED [ 30%]
src/rawnind/dependencies/tests/test_openEXR_bit_depth.py::test_openEXR_bit_depth[16] PASSED [ 30%]
src/rawnind/dependencies/tests/test_openEXR_bit_depth.py::test_openEXR_bit_depth[32] PASSED [ 31%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_l1_loss PASSED    [ 31%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_mse_loss PASSED   [ 31%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_psnr_metric PASSED [ 31%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_loss_basic PASSED [ 32%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_size_constraint[160] PASSED [ 32%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_size_constraint[159] PASSED [ 32%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_size_constraint[64] PASSED [ 32%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_size_constraint[32] PASSED [ 32%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_valid_size PASSED [ 33%]
src/rawnind/dependencies/tests/test_pt_losses.py::test_ms_ssim_metric PASSED [ 33%]
src/rawnind/dependencies/tests/test_pytorch_helpers.py::test_get_basic_linear_schedule_with_warmup PASSED [ 33%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_pt_crop_batch PASSED [ 33%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_img_to_batch_to_img_round_trip PASSED [ 33%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_img_to_batch_truncation PASSED [ 34%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_pixel_unshuffle_functional PASSED [ 34%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_pixel_unshuffle_inverse_pixel_shuffle PASSED [ 34%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_oneloss PASSED [ 34%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_fragile_checksum PASSED [ 35%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_round_no_gradient_forward PASSED [ 35%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_round_no_gradient_backward PASSED [ 35%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_crop_to_multiple PASSED [ 35%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_gamma_pt_positive_values PASSED [ 35%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_gamma_pt_non_positive_values PASSED [ 36%]
src/rawnind/dependencies/tests/test_pytorch_operations.py::TestPyTorchOperations::test_gamma_pt_in_place PASSED [ 36%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_raw_loader_load_raw_data PASSED [ 36%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestRawLoaderInternalMethods::test_remove_empty_borders PASSED [ 36%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestRawLoaderInternalMethods::test_remove_empty_borders_with_crop_all PASSED [ 36%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_bayer_processor_initialization PASSED [ 37%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_bayer_processor_apply_white_balance_numerical PASSED [ 37%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_demosaic_function PASSED [ 37%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_demosaic_integration_real_cv2 PASSED [ 37%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_bayer_pattern_transformations PASSED [ 38%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestExposureCheck::test_is_exposure_ok_good_exposure PASSED [ 38%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestExposureCheck::test_is_exposure_ok_overexposed PASSED [ 38%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestExposureCheck::test_is_exposure_ok_underexposed PASSED [ 38%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestExposureCheck::test_is_exposure_ok_mix_within_threshold PASSED [ 38%]
src/rawnind/dependencies/tests/test_raw_processing.py::TestExposureCheck::test_is_exposure_ok_mix_exceeding_threshold PASSED [ 39%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_color_transformer_initialization PASSED [ 39%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_color_transformer_matrix_methods PASSED [ 39%]
src/rawnind/dependencies/tests/test_raw_processing.py::test_color_transformer_camrgb_to_profiledrgb_img_numerical PASSED [ 39%]
src/rawnind/dependencies/tests/test_top_level_api.py::test_raw_fpath_to_rggb_img_and_metadata PASSED [ 40%]
src/rawnind/dependencies/tests/test_top_level_api.py::test_is_exposure_ok PASSED [ 40%]
src/rawnind/dependencies/tests/test_top_level_api.py::test_is_xtrans PASSED [ 40%]
src/rawnind/dependencies/tests/test_top_level_api.py::test_xtrans_fpath_to_OpenEXR PASSED [ 40%]
src/rawnind/dependencies/tests/test_top_level_api.py::test_raw_fpath_to_hdr_img_file_success PASSED [ 40%]
src/rawnind/dependencies/tests/test_top_level_api.py::test_raw_fpath_to_hdr_img_file_exposure_failure PASSED [ 41%]
src/rawnind/inference/tests/test_bm3d_denoiser.py::test_bm3d_denoiser_forward_pass FAILED [ 41%]
src/rawnind/inference/tests/test_bm3d_denoiser.py::test_bm3d_denoiser_invalid_input PASSED [ 41%]
src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_init ERROR [ 41%]
src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_compress_and_denoise[input_shape0-expected_output_shape0] ERROR [ 41%]
src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_compress_and_denoise[input_shape1-expected_output_shape1] ERROR [ 42%]
src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_decompress PASSED [ 42%]
src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_compress_alias ERROR [ 42%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_init PASSED [ 42%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_denoise[input_shape0-expected_output_shape0] FAILED [ 43%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_denoise[input_shape1-expected_output_shape1] PASSED [ 43%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_denoise_batch PASSED [ 43%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_denoise_input_channel_validation PASSED [ 43%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_denoise_return_dict PASSED [ 43%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_init FAILED [ 44%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer[input_shape0-gt_shape0-expected_output_shape0] FAILED [ 44%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer[input_shape1-gt_shape1-expected_output_shape1] FAILED [ 44%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer_input_channel_validation FAILED [ 44%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer_rgb_xyz_matrix_validation FAILED [ 44%]
src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer_return_dict FAILED [ 45%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[cpu--1] PASSED [ 45%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[cuda-0] PASSED [ 45%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[cuda:0-0] PASSED [ 45%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[cuda:1-1] PASSED [ 46%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[input_device4--1] PASSED [ 46%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[input_device5-0] PASSED [ 46%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[input_device6-1] PASSED [ 46%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[-1--1] PASSED [ 46%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[0-0] PASSED [ 47%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[1-1] PASSED [ 47%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_valid_device_conversions[custom_device-custom_device] PASSED [ 47%]
src/rawnind/inference/tests/test_device_conversion.py::TestConvertDeviceFormat::test_unsupported_device_type_raises_error PASSED [ 47%]
src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_rgb_denoiser_inference_e2e FAILED [ 47%]
src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_bayer_denoiser_inference_e2e FAILED [ 48%]
src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_compressor_inference_e2e FAILED [ 48%]
src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_load_model_from_checkpoint_robustness FAILED [ 48%]
src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_compute_image_metrics FAILED [ 48%]
src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_convert_device_format PASSED [ 49%]
src/rawnind/inference/tests/test_ext_raw_denoise.py::test_ext_raw_denoise ERROR [ 49%]
src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_metrics_computation FAILED [ 49%]
src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_image_shapes_mismatch PASSED [ 49%]
src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_ms_ssim_size_constraint PASSED [ 49%]
src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_unknown_metric_handling FAILED [ 50%]
src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_masking_application FAILED [ 50%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_valid_denoiser_config_init PASSED [ 50%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_valid_compressor_config_init PASSED [ 50%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_invalid_inference_config_raises_error[architecture-unsupported_arch-Unsupported architecture] PASSED [ 50%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_invalid_inference_config_raises_error[input_channels-0-Input channels must be 3 or 4] PASSED [ 51%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_invalid_inference_config_raises_error[input_channels-5-Input channels must be 3 or 4] PASSED [ 51%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_invalid_inference_config_raises_error[match_gain-invalid_gain-Invalid match_gain option] PASSED [ 51%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_preupsampling_validation PASSED [ 51%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[unet] PASSED [ 52%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[utnet3] PASSED [ 52%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[identity] PASSED [ 52%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[bm3d] PASSED [ 52%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[ManyPriors] PASSED [ 52%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[DenoiseThenCompress] PASSED [ 53%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[JPEGXL] PASSED [ 53%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[JPEG] PASSED [ 53%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[Passthrough] PASSED [ 53%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[standard] PASSED [ 53%]
src/rawnind/inference/tests/test_inference_config.py::TestInferenceConfig::test_all_supported_architectures[autoencoder] PASSED [ 54%]
src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_valid_metric PASSED [ 54%]
src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_default_metric FAILED [ 54%]
src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_metric_not_found PASSED [ 54%]
src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_missing_trainres PASSED [ 55%]
src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_missing_args PASSED [ 55%]
src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_missing_checkpoint_file PASSED [ 55%]
src/rawnind/inference/tests/test_playraw.py::test_playraw ERROR          [ 55%]
src/rawnind/inference/tests/test_pytorch_integration.py::test_model_device_placement ERROR [ 55%]
src/rawnind/inference/tests/test_pytorch_integration.py::test_model_forward_pass ERROR [ 56%]
src/rawnind/inference/tests/test_pytorch_integration.py::test_model_inference_method ERROR [ 56%]
src/rawnind/inference/tests/test_pytorch_integration.py::test_batch_handling ERROR [ 56%]
src/rawnind/inference/tests/test_standard_compressor.py::test_standard_compressor_forward_pass FAILED [ 56%]
src/rawnind/inference/tests/test_standard_compressor.py::test_standard_compressor_invalid_input FAILED [ 56%]
src/rawnind/tests/acceptance/test_dataset_base_contracts.py::test_random_crops_and_center_crop_shapes FAILED [ 57%]
src/rawnind/tests/acceptance/test_dataset_base_contracts.py::test_clean_clean_dataset_available PASSED [ 57%]
src/rawnind/tests/acceptance/test_dependencies_and_experiments.py::test_yaml_roundtrip PASSED [ 57%]
src/rawnind/tests/acceptance/test_dependencies_and_experiments.py::test_experiment_manager_cleanup PASSED [ 57%]
src/rawnind/tests/acceptance/test_dependencies_and_experiments.py::test_experiment_manager_rm_empty FAILED [ 58%]
src/rawnind/tests/acceptance/test_dependencies_and_experiments.py::test_get_best_steps_from_results PASSED [ 58%]
src/rawnind/tests/acceptance/test_imports_and_layout.py::test_modules_and_symbols_present[rawnind.training.training_loops-symbol_names0] PASSED [ 58%]
src/rawnind/tests/acceptance/test_imports_and_layout.py::test_modules_and_symbols_present[rawnind.training.experiment_manager-symbol_names1] PASSED [ 58%]
src/rawnind/tests/acceptance/test_imports_and_layout.py::test_modules_and_symbols_present[rawnind.dataset.base_dataset-symbol_names2] PASSED [ 58%]
src/rawnind/tests/acceptance/test_imports_and_layout.py::test_modules_and_symbols_present[rawnind.inference.inference_engine-symbol_names3] PASSED [ 59%]
src/rawnind/tests/acceptance/test_imports_and_layout.py::test_modules_and_symbols_present[rawnind.dependencies.json_saver-symbol_names4] PASSED [ 59%]
src/rawnind/tests/acceptance/test_inference_engine.py::test_infer_tensor_and_batch[shape0] PASSED [ 59%]
src/rawnind/tests/acceptance/test_inference_engine.py::test_infer_tensor_and_batch[shape1] PASSED [ 59%]
src/rawnind/tests/acceptance/test_inference_engine.py::test_infer_output_modes[True] PASSED [ 60%]
src/rawnind/tests/acceptance/test_inference_engine.py::test_infer_output_modes[False] PASSED [ 60%]
src/rawnind/tests/acceptance/test_inference_engine.py::test_transfer_function_factory_available FAILED [ 60%]
src/rawnind/tests/acceptance/test_legacy_cli_removed.py::TestLegacyCliRemoved::test_no_legacy_libs_namespace PASSED [ 60%]
src/rawnind/tests/acceptance/test_legacy_cli_removed.py::TestLegacyCliRemoved::test_legacy_root_modules_not_under_package PASSED [ 60%]
src/rawnind/tests/acceptance/test_legacy_cli_removed.py::TestLegacyCliRemoved::test_core_modules_have_no_main_blocks PASSED [ 61%]
src/rawnind/tests/acceptance/test_legacy_cli_removed.py::TestLegacyCliRemoved::test_importing_core_modules_does_not_parse_cli PASSED [ 61%]
src/rawnind/tests/acceptance/test_legacy_cli_removed.py::TestLegacyCliRemoved::test_pyproject_has_no_legacy_console_scripts FAILED [ 61%]
src/rawnind/tests/acceptance/test_policy_no_skip.py::test_no_skip_markers_in_acceptance_suite PASSED [ 61%]
src/rawnind/tests/acceptance/test_policy_no_xfail.py::test_no_xfail_markers_in_acceptance_suite PASSED [ 61%]
src/rawnind/tests/acceptance/test_training_loops_smoke.py::test_training_loops_contract_lightweight PASSED [ 62%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFactoryFunctions::test_create_rgb_training_dataset FAILED [ 62%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFactoryFunctions::test_create_bayer_training_dataset FAILED [ 62%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFactoryFunctions::test_create_self_supervised_dataset FAILED [ 62%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetConfigurationAndValidation::test_dataset_config_validation FAILED [ 63%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetConfigurationAndValidation::test_validate_dataset_format PASSED [ 63%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetPreprocessingAndAugmentation::test_image_cropping_and_masking FAILED [ 63%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetPreprocessingAndAugmentation::test_bayer_pattern_alignment PASSED [ 63%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetPreprocessingAndAugmentation::test_data_augmentation_pipeline FAILED [ 63%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetSplitsAndReservedData::test_prepare_dataset_splits PASSED [ 64%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetSplitsAndReservedData::test_test_reserve_enforcement FAILED [ 64%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetValidationAndMetadata::test_dataset_metadata_loading PASSED [ 64%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetValidationAndMetadata::test_dataset_integrity_validation PASSED [ 64%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetLoadingPerformance::test_lazy_loading_behavior PASSED [ 64%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetLoadingPerformance::test_multiprocessing_data_loading PASSED [ 65%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestSpecializedDatasetTypes::test_rawnind_academic_dataset PASSED [ 65%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestSpecializedDatasetTypes::test_hdr_dataset_support PASSED [ 65%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFormatConversions::test_color_space_conversion PASSED [ 65%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFormatConversions::test_bayer_demosaicing_options PASSED [ 66%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetIntegrationWithTraining::test_dataset_trainer_integration FAILED [ 66%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetIntegrationWithTraining::test_dataset_preprocessing_pipeline FAILED [ 66%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetErrorHandling::test_missing_data_handling PASSED [ 66%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetErrorHandling::test_insufficient_valid_pixels_handling PASSED [ 66%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetStatisticsAndAnalysis::test_dataset_statistics_computation PASSED [ 67%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetStatisticsAndAnalysis::test_noise_level_analysis PASSED [ 67%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetValidationDataLoaders::test_create_validation_dataset FAILED [ 67%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetValidationDataLoaders::test_create_test_dataset FAILED [ 67%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetCachingAndPerformance::test_dataset_caching_behavior FAILED [ 67%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestRawNINDAcademicDatasetSupport::test_rawnind_dataset_loading PASSED [ 68%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestRawNINDAcademicDatasetSupport::test_rawnind_test_reserve_handling PASSED [ 68%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetUtilitiesAndHelpers::test_dataset_format_conversion FAILED [ 68%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetUtilitiesAndHelpers::test_dataset_subset_creation FAILED [ 68%]
src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetQualityAssurance::test_image_quality_validation FAILED [ 69%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_rgb_denoising_pipeline_real SKIPPED [ 69%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_bayer_denoising_pipeline_real SKIPPED [ 69%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_vs_legacy_comparison FAILED [ 69%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_real_model_loading_robustness PASSED [ 69%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_memory_efficiency FAILED [ 70%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_batch_processing_real FAILED [ 70%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_architecture_switching PASSED [ 70%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_error_handling FAILED [ 70%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiRealWorldUsage::test_production_like_workflow SKIPPED [ 70%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiRealWorldUsage::test_clean_api_full_inference_pipeline FAILED [ 71%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiZeroCLIDependencies::test_no_cli_imports_in_clean_api FAILED [ 71%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiZeroCLIDependencies::test_programmatic_instantiation_only FAILED [ 71%]
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiZeroCLIDependencies::test_no_file_side_effects FAILED [ 71%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_create_rgb_denoiser_basic FAILED [ 72%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_create_bayer_denoiser_basic FAILED [ 72%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_create_compressor_basic FAILED [ 72%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_load_model_from_checkpoint_rgb SKIPPED [ 72%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_load_model_from_checkpoint_bayer SKIPPED [ 72%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_rgb_denoising_inference FAILED [ 73%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_bayer_denoising_inference FAILED [ 73%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_batch_inference FAILED [ 73%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_compute_image_metrics_standalone FAILED [ 73%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_model_architecture_options FAILED [ 73%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_device_handling FAILED [ 74%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_inference_engine_clean_api PASSED [ 74%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_rgb_end_to_end_pipeline FAILED [ 74%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_bayer_end_to_end_pipeline FAILED [ 74%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_model_loading_from_experiment_directory SKIPPED [ 75%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_compression_end_to_end_pipeline FAILED [ 75%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_file_based_processing_pipeline FAILED [ 75%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceConfiguration::test_custom_model_parameters FAILED [ 75%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceConfiguration::test_bayer_specific_options FAILED [ 75%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceConfiguration::test_metrics_configuration FAILED [ 76%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceIntegration::test_production_workflow_rgb_denoising SKIPPED [ 76%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceIntegration::test_production_workflow_bayer_denoising SKIPPED [ 76%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceIntegration::test_model_comparison_workflow FAILED [ 76%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceIntegration::test_memory_efficient_processing FAILED [ 76%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_architecture_error FAILED [ 77%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_checkpoint_path_error PASSED [ 77%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_image_shape_error FAILED [ 77%]
src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_metrics_error FAILED [ 77%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingFactoryFunctions::test_create_denoiser_trainer_rgb FAILED [ 78%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingFactoryFunctions::test_create_denoiser_trainer_bayer FAILED [ 78%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingFactoryFunctions::test_create_denoise_compress_trainer PASSED [ 78%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingFactoryFunctions::test_create_experiment_manager PASSED [ 78%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingConfigClasses::test_training_config_validation PASSED [ 78%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingConfigClasses::test_experiment_config_path_resolution PASSED [ 79%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestCleanTrainingWorkflow::test_training_workflow_rgb_denoiser FAILED [ 79%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestCleanTrainingWorkflow::test_training_workflow_bayer_denoiser FAILED [ 79%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestModelCheckpointingAndResumption::test_save_and_load_checkpoint FAILED [ 79%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestModelCheckpointingAndResumption::test_resume_training_from_checkpoint FAILED [ 80%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestExperimentManagement::test_experiment_manager_basic_functionality FAILED [ 80%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestExperimentManagement::test_experiment_cleanup FAILED [ 80%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingDataIntegration::test_training_with_real_dataset_interface FAILED [ 80%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingValidationAndTesting::test_standalone_validation FAILED [ 80%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingValidationAndTesting::test_custom_test_evaluation FAILED [ 81%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestHyperparameterManagement::test_learning_rate_scheduling FAILED [ 81%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestHyperparameterManagement::test_early_stopping FAILED [ 81%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingMetrics::test_loss_computation FAILED [ 81%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingMetrics::test_metrics_computation_during_training FAILED [ 81%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestJointDenoiseCompressTraining::test_denoise_compress_trainer_creation PASSED [ 82%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestJointDenoiseCompressTraining::test_joint_loss_computation PASSED [ 82%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestBayerSpecificTraining::test_bayer_training_with_demosaicing FAILED [ 82%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestBayerSpecificTraining::test_bayer_color_matrix_handling FAILED [ 82%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingConfigurationValidation::test_invalid_model_architecture PASSED [ 83%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingConfigurationValidation::test_invalid_loss_function PASSED [ 83%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingConfigurationValidation::test_channel_mismatch_validation PASSED [ 83%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingModelArchitectures::test_unet_architecture_training FAILED [ 83%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingModelArchitectures::test_autoencoder_architecture_training PASSED [ 83%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestMultiDeviceTraining::test_cpu_training FAILED [ 84%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestMultiDeviceTraining::test_gpu_training SKIPPED [ 84%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingOutputSaving::test_save_training_visualizations FAILED [ 84%]
src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingOutputSaving::test_save_validation_outputs FAILED [ 84%]
src/rawnind/training/tests/test_alignment.py::test_image_alignment SKIPPEDrog_tr.jpg there.) [ 84%]
src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_rgb_denoiser_training_e2e ERROR [ 85%]
src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_bayer_denoiser_training_e2e ERROR [ 85%]
src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_ms_ssim_crop_size_validation ERROR [ 85%]
src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_denoise_compress_training_e2e ERROR [ 85%]
src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_clean_trainer_checkpoint_security ERROR [ 86%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_init_valid ERROR [ 86%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_init_missing_compression_lambda ERROR [ 86%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_create_optimizer_multiple_param_groups ERROR [ 86%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_compute_loss_with_bpp ERROR [ 86%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_compute_loss_without_bpp ERROR [ 87%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_get_optimizer_param_groups ERROR [ 87%]
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_compute_joint_loss ERROR [ 87%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_rgb_valid FAILED [ 87%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_bayer_valid FAILED [ 87%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_rgb_invalid_channels FAILED [ 88%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_bayer_invalid_channels FAILED [ 88%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_process_bayer_output[4-True-expected_camrgb_call_shape0] FAILED [ 88%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_process_bayer_output[3-False-expected_camrgb_call_shape1] FAILED [ 88%]
src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_process_bayer_output_unsupported_channels FAILED [ 89%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_init PASSED [ 89%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_record_metrics_loss_improvement FAILED [ 89%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_record_metrics_psnr_improvement FAILED [ 89%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_get_best_steps FAILED [ 89%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_should_save_checkpoint PASSED [ 90%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_cleanup_checkpoints FAILED [ 90%]
src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_cleanup_checkpoints_not_enough_best FAILED [ 90%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_init PASSED [ 90%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_model_rgb FAILED [ 90%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_model_bayer FAILED [ 91%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_optimizer PASSED [ 91%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_loss_function[mse-MSE_loss] FAILED [ 91%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_loss_function[ms_ssim-MS_SSIM_loss] FAILED [ 91%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_loss_function[l1-L1Loss] FAILED [ 92%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-False-1] FAILED [ 92%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[False-False-1] FAILED [ 92%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-True-2] FAILED [ 92%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-True-1] FAILED [ 92%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-True-0.5] FAILED [ 93%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_update_learning_rate_improvement PASSED [ 93%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_update_learning_rate_decay FAILED [ 93%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_save_and_load_checkpoint PASSED [ 93%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_prepare_datasets_mock_fallback[True] FAILED [ 93%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_prepare_datasets_mock_fallback[False] FAILED [ 94%]
src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_validate_and_test_flow FAILED [ 94%]
src/rawnind/training/tests/test_experiment_config.py::TestExperimentConfig::test_valid_experiment_config_init PASSED [ 94%]
src/rawnind/training/tests/test_experiment_config.py::TestExperimentConfig::test_default_values PASSED [ 94%]
src/rawnind/training/tests/test_experiment_config.py::TestExperimentConfig::test_directory_creation_on_init PASSED [ 95%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-bayer-dc] ERROR [ 95%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-bayer-denoise] ERROR [ 95%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-prgb-dc] ERROR [ 95%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-prgb-denoise] ERROR [ 95%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-bayer-dc] ERROR [ 96%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-bayer-denoise] ERROR [ 96%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-prgb-dc] ERROR [ 96%]
src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-prgb-denoise] ERROR [ 96%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_valid_config_init PASSED [ 96%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[learning_rate-0-Learning rate must be positive] PASSED [ 97%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[batch_size-0-Batch size must be positive] PASSED [ 97%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[crop_size-0-Crop size must be positive] PASSED [ 97%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[total_steps-0-Total steps must be positive] PASSED [ 97%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[validation_interval-0-Validation interval must be positive] PASSED [ 98%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[model_architecture-invalid_arch-Unsupported model architecture] PASSED [ 98%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_invalid_training_config_raises_error[loss_function-invalid_loss-Unsupported loss function] PASSED [ 98%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_ms_ssim_crop_size_constraint PASSED [ 98%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_create_training_config_from_yaml FAILED [ 98%]
src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_create_training_config_from_yaml_with_overrides PASSED [ 99%]
src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DCTrainingBayerToProfiledRGB] ERROR [ 99%]
src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DCTrainingProfiledRGBToProfiledRGB] ERROR [ 99%]
src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DenoiserTrainingBayerToProfiledRGB] ERROR [ 99%]
src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DenoiserTrainingProfiledRGBToProfiledRGB] ERROR [100%]

=============================== warnings summary ===============================
src/rawnind/dataset/test_dataloaders.py:29
  /home/rengo/rawnind_jddc/src/rawnind/dataset/test_dataloaders.py:29: PytestCollectionWarning: cannot collect test class 'TestDataLoader' because it has a __init__ constructor (from: src/rawnind/dataset/test_dataloaders.py)
    class TestDataLoader:

src/rawnind/dataset/tests/test_integration.py:227
  /home/rengo/rawnind_jddc/src/rawnind/dataset/tests/test_integration.py:227: PytestCollectionWarning: cannot collect test class 'TestDataLoader' because it has a __init__ constructor (from: src/rawnind/dataset/tests/test_integration.py)
    class TestDataLoader:

src/rawnind/dependencies/tests/test_pytorch_helpers.py::test_get_basic_linear_schedule_with_warmup
  /home/rengo/rawnind_jddc/.venv/lib/python3.13/site-packages/torch/optim/lr_scheduler.py:192: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
    warnings.warn(

src/rawnind/tests/acceptance/test_inference_engine.py::test_transfer_function_factory_available
  /home/rengo/rawnind_jddc/.venv/lib/python3.13/site-packages/numpy/_core/fromnumeric.py:48: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    return conv.wrap(result, to_scalar=False)

src/rawnind/tests/acceptance/test_inference_engine.py::test_transfer_function_factory_available
src/rawnind/tests/acceptance/test_inference_engine.py::test_transfer_function_factory_available
  /home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py:821: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    pq = ((c1 + c2 * np.power(img_norm, m1)) / (1 + c3 * np.power(img_norm, m1))) ** m2

src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_validate_and_test_flow
  /home/rengo/rawnind_jddc/.venv/lib/python3.13/site-packages/torch/nn/modules/loss.py:616: UserWarning: Using a target size (torch.Size([1, 3, 128, 128])) that is different to the input size (<MagicMock name='create_rgb_denoiser().model().__mul__().size()' id='124534152529632'>). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
    return F.mse_loss(input, target, reduction=self.reduction)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.13.7-final-0 ________________

Name                                                                Stmts   Miss  Cover
---------------------------------------------------------------------------------------
src/rawnind/__init__.py                                                 1      0   100%
src/rawnind/core/__init__.py                                            6      6     0%
src/rawnind/core/operation_registry.py                                137    137     0%
src/rawnind/core/operation_resolver.py                                135    135     0%
src/rawnind/core/operation_spec.py                                     87     87     0%
src/rawnind/core/pipeline_assembler.py                                148    148     0%
src/rawnind/core/pipeline_operation.py                                 51     51     0%
src/rawnind/dataset/__init__.py                                         9      0   100%
src/rawnind/dataset/base_dataset.py                                    95     56    41%
src/rawnind/dataset/bayer_datasets.py                                 173    146    16%
src/rawnind/dataset/clean_api.py                                      250     52    79%
src/rawnind/dataset/clean_datasets.py                                 105     89    15%
src/rawnind/dataset/dataset_config.py                                  77      0   100%
src/rawnind/dataset/noisy_datasets.py                                  81     68    16%
src/rawnind/dataset/rgb_datasets.py                                   212    189    11%
src/rawnind/dataset/test_dataloaders.py                               115     87    24%
src/rawnind/dataset/tests/__init__.py                                   0      0   100%
src/rawnind/dataset/tests/test_anti_patterns.py                        35      6    83%
src/rawnind/dataset/tests/test_configurable_dataset.py                  8      0   100%
src/rawnind/dataset/tests/test_dataset_config.py                       53      0   100%
src/rawnind/dataset/tests/test_datasets_load_time.py                   21     16    24%
src/rawnind/dataset/tests/test_integration.py                         176     52    70%
src/rawnind/dataset/tests/test_manproc.py                              45      9    80%
src/rawnind/dataset/tests/test_validation.py                           50      2    96%
src/rawnind/dataset/validation_datasets.py                            177    139    21%
src/rawnind/dependencies/__init__.py                                    4      0   100%
src/rawnind/dependencies/arbitrary_processing.py                      229    192    16%
src/rawnind/dependencies/color_management.py                            2      0   100%
src/rawnind/dependencies/compression.py                               170     90    47%
src/rawnind/dependencies/config_manager.py                             32      0   100%
src/rawnind/dependencies/external_libraries.py                         60     28    53%
src/rawnind/dependencies/image_analysis.py                            106     81    24%
src/rawnind/dependencies/json_saver.py                                 91      2    98%
src/rawnind/dependencies/locking.py                                    73     17    77%
src/rawnind/dependencies/numpy_operations.py                          134     34    75%
src/rawnind/dependencies/pt_losses.py                                  25      0   100%
src/rawnind/dependencies/pytorch_helpers.py                            82     63    23%
src/rawnind/dependencies/pytorch_operations.py                         75     15    80%
src/rawnind/dependencies/raw_processing.py                            437    122    72%
src/rawnind/dependencies/tests/__init__.py                              0      0   100%
src/rawnind/dependencies/tests/conftest.py                             23      0   100%
src/rawnind/dependencies/tests/test_config_manager.py                  77      0   100%
src/rawnind/dependencies/tests/test_file_io.py                        150      8    95%
src/rawnind/dependencies/tests/test_json_saver.py                     201      0   100%
src/rawnind/dependencies/tests/test_locking.py                        108      0   100%
src/rawnind/dependencies/tests/test_numpy_operations.py               173      1    99%
src/rawnind/dependencies/tests/test_openEXR_bit_depth.py               17      0   100%
src/rawnind/dependencies/tests/test_pt_losses.py                       56      2    96%
src/rawnind/dependencies/tests/test_pytorch_helpers.py                 19      0   100%
src/rawnind/dependencies/tests/test_pytorch_operations.py              97      1    99%
src/rawnind/dependencies/tests/test_raw_processing.py                 169      0   100%
src/rawnind/dependencies/tests/test_top_level_api.py                  112     20    82%
src/rawnind/inference/__init__.py                                       5      0   100%
src/rawnind/inference/base_inference.py                               250    156    38%
src/rawnind/inference/batch_inference.py                               94     94     0%
src/rawnind/inference/clean_api.py                                    356    161    55%
src/rawnind/inference/configs.py                                       66     26    61%
src/rawnind/inference/image_denoiser.py                               113    105     7%
src/rawnind/inference/inference_engine.py                              42      2    95%
src/rawnind/inference/model_factory.py                                 71     37    48%
src/rawnind/inference/simple_denoiser.py                               41     41     0%
src/rawnind/inference/tests/__init__.py                                 0      0   100%
src/rawnind/inference/tests/test_bm3d_denoiser.py                      34     15    56%
src/rawnind/inference/tests/test_clean_compressor.py                   64     28    56%
src/rawnind/inference/tests/test_clean_denoiser.py                     99     30    70%
src/rawnind/inference/tests/test_device_conversion.py                  14      0   100%
src/rawnind/inference/tests/test_e2e_inference_clean_api.py           166     69    58%
src/rawnind/inference/tests/test_ext_raw_denoise.py                    27     22    19%
src/rawnind/inference/tests/test_image_metrics.py                      55     12    78%
src/rawnind/inference/tests/test_inference_config.py                   37      0   100%
src/rawnind/inference/tests/test_model_checkpoint.py                   48      2    96%
src/rawnind/inference/tests/test_playraw.py                            33     28    15%
src/rawnind/inference/tests/test_pytorch_integration.py                44     34    23%
src/rawnind/inference/tests/test_standard_compressor.py                47     24    49%
src/rawnind/models/__init__.py                                          2      0   100%
src/rawnind/models/bitEstimator.py                                     39     14    64%
src/rawnind/models/bm3d_denoiser.py                                    45     17    62%
src/rawnind/models/compression_autoencoders.py                        101     32    68%
src/rawnind/models/denoise_then_compress.py                            32     18    44%
src/rawnind/models/manynets_compression.py                            106     79    25%
src/rawnind/models/raw_denoiser.py                                     97     76    22%
src/rawnind/models/standard_compressor.py                              59     18    69%
src/rawnind/operations/__init__.py                                      5      5     0%
src/rawnind/operations/models.py                                       97     97     0%
src/rawnind/operations/postprocessing.py                               46     46     0%
src/rawnind/operations/preprocessing.py                                64     64     0%
src/rawnind/tests/__init__.py                                           1      0   100%
src/rawnind/tests/acceptance/__init__.py                                0      0   100%
src/rawnind/tests/acceptance/package_refactoring_validation.py         40     40     0%
src/rawnind/tests/acceptance/test_dataset_base_contracts.py            27     14    48%
src/rawnind/tests/acceptance/test_dependencies_and_experiments.py      34      0   100%
src/rawnind/tests/acceptance/test_imports_and_layout.py                 8      0   100%
src/rawnind/tests/acceptance/test_inference_engine.py                  41      0   100%
src/rawnind/tests/acceptance/test_legacy_cli_removed.py                40      4    90%
src/rawnind/tests/acceptance/test_policy_no_skip.py                    18      2    89%
src/rawnind/tests/acceptance/test_policy_no_xfail.py                   18      2    89%
src/rawnind/tests/acceptance/test_raw_processing_vs_rawpy.py           88     73    17%
src/rawnind/tests/acceptance/test_training_loops_smoke.py              25      9    64%
src/rawnind/tests/conftest.py                                         198    166    16%
src/rawnind/tests/download_sample_data.py                              65     57    12%
src/rawnind/tests/test_e2e_dataset_clean_api.py                       462     98    79%
src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py         204    130    36%
src/rawnind/tests/test_e2e_inference_clean_api.py                     236    120    49%
src/rawnind/tests/test_e2e_training_clean_api.py                      355    175    51%
src/rawnind/tools/__init__.py                                           0      0   100%
src/rawnind/tools/add_msssim_score_to_dataset_yaml_descriptor.py       42     42     0%
src/rawnind/tools/capture_image_set.py                                 86     86     0%
src/rawnind/tools/check_dataset.py                                     39     39     0%
src/rawnind/tools/cleanup_saved_models_iterations.py                   99     99     0%
src/rawnind/tools/cleanup_saved_models_unused_test_images.py          100    100     0%
src/rawnind/tools/crop_datasets.py                                    144    144     0%
src/rawnind/tools/find_best_expname_iteration.py                       60     60     0%
src/rawnind/tools/gather_raw_gt_images.py                              54     54     0%
src/rawnind/tools/make_hdr_extraraw_files.py                           49     49     0%
src/rawnind/tools/make_hdr_rawnind_files.py                            68     68     0%
src/rawnind/tools/mse.py                                                7      7     0%
src/rawnind/tools/prep_image_dataset.py                                96     96     0%
src/rawnind/tools/prep_image_dataset_extraraw.py                       78     78     0%
src/rawnind/tools/rm_empty_models.py                                   46     46     0%
src/rawnind/tools/rm_nonbest_model_iterations.py                        0      0   100%
src/rawnind/tools/save_src.py                                          19     19     0%
src/rawnind/tools/summarize_dataset.py                                145    145     0%
src/rawnind/tools/train_and_run_bayer_denoiser.py                     436    436     0%
src/rawnind/tools/xtrans_to_openexr_dataset.py                         23     23     0%
src/rawnind/training/__init__.py                                        4      0   100%
src/rawnind/training/clean_api.py                                     493    198    60%
src/rawnind/training/denoise_compress_trainer.py                       31     10    68%
src/rawnind/training/denoiser_trainer.py                               34     10    71%
src/rawnind/training/experiment_manager.py                            273    198    27%
src/rawnind/training/tests/__init__.py                                  0      0   100%
src/rawnind/training/tests/test_alignment.py                           15      6    60%
src/rawnind/training/tests/test_clean_api_e2e_training.py             134    100    25%
src/rawnind/training/tests/test_clean_denoise_compress_trainer.py     110     84    24%
src/rawnind/training/tests/test_clean_denoiser_trainer.py              64     28    56%
src/rawnind/training/tests/test_clean_experiment_manager.py           103     34    67%
src/rawnind/training/tests/test_clean_trainer.py                      155     61    61%
src/rawnind/training/tests/test_experiment_config.py                   40      0   100%
src/rawnind/training/tests/test_progressive_rawnind.py                 35     27    23%
src/rawnind/training/tests/test_training_config.py                     53     10    81%
src/rawnind/training/tests/test_validate_and_test.py                   23     10    57%
src/rawnind/training/training_loops.py                                611    539    12%
---------------------------------------------------------------------------------------
TOTAL                                                               12997   7299    44%
=========================== short test summary info ============================
FAILED src/rawnind/dataset/tests/test_anti_patterns.py::test_critical_classes_are_singletons - Failed: Critical class 'ProfiledRGBProfiledRGBImageCropsDataset' not found in any dataset module.
FAILED src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_quality_thresholds_default - AssertionError: assert {'max_alignment_error': 0.035, 'max_overexposure_ratio': 0.01, 'min_image_quality_score': 0.7, 'max_image_quality_score': 1.0} == {'max_alignment_error': 0.035, 'max_overexposure_ratio': 0.01, 'min_image_quality_score': 0.7}
  
  Common items:
  {'max_alignment_error': 0.035,
   'max_overexposure_ratio': 0.01,
   'min_image_quality_score': 0.7}
  Left contains 1 more item:
  {'max_image_quality_score': 1.0}
  
  Full diff:
    {
        'max_alignment_error': 0.035,
  +     'max_image_quality_score': 1.0,
        'max_overexposure_ratio': 0.01,
        'min_image_quality_score': 0.7,
    }
FAILED src/rawnind/dataset/tests/test_dataset_config.py::test_dataset_config_quality_thresholds_custom - AssertionError: assert {'max_alignment_error': 0.035, 'max_overexposure_ratio': 0.01, 'min_image_quality_score': 0.7, 'max_image_quality_score': 1.0, 'custom_metric': 0.9} == {'custom_metric': 0.9}
  
  Common items:
  {'custom_metric': 0.9}
  Left contains 4 more items:
  {'max_alignment_error': 0.035,
   'max_image_quality_score': 1.0,
   'max_overexposure_ratio': 0.01,
   'min_image_quality_score': 0.7}
  
  Full diff:
    {
        'custom_metric': 0.9,
  +     'max_alignment_error': 0.035,
  +     'max_image_quality_score': 1.0,
  +     'max_overexposure_ratio': 0.01,
  +     'min_image_quality_score': 0.7,
    }
FAILED src/rawnind/dataset/tests/test_integration.py::test_create_training_dataset_msssim_filter[0.96-1.0-0] - ValueError: No images found in the dataset.
FAILED src/rawnind/inference/tests/test_bm3d_denoiser.py::test_bm3d_denoiser_forward_pass - ImportError: import error in rawnind.libs: No module named 'rawnind.libs'
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanDenoiser::test_denoise[input_shape0-expected_output_shape0] - RuntimeError: Boolean value of Tensor with more than one value is ambiguous
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_init - ImportError: cannot import name 'demosaic' from 'rawnind.dependencies.raw_processing' (/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py)
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer[input_shape0-gt_shape0-expected_output_shape0] - AttributeError: <module 'rawnind.dependencies.raw_processing' from '/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py'> does not have the attribute 'demosaic'
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer[input_shape1-gt_shape1-expected_output_shape1] - AttributeError: <module 'rawnind.dependencies.raw_processing' from '/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py'> does not have the attribute 'demosaic'
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer_input_channel_validation - ImportError: cannot import name 'demosaic' from 'rawnind.dependencies.raw_processing' (/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py)
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer_rgb_xyz_matrix_validation - ImportError: cannot import name 'demosaic' from 'rawnind.dependencies.raw_processing' (/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py)
FAILED src/rawnind/inference/tests/test_clean_denoiser.py::TestCleanBayerDenoiser::test_denoise_bayer_return_dict - ImportError: cannot import name 'demosaic' from 'rawnind.dependencies.raw_processing' (/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py)
FAILED src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_rgb_denoiser_inference_e2e - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_bayer_denoiser_inference_e2e - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_compressor_inference_e2e - TypeError: rawnind.inference.clean_api.InferenceConfig() got multiple values for keyword argument 'hidden_out_channels'
FAILED src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_load_model_from_checkpoint_robustness - NameError: name 'yaml' is not defined
FAILED src/rawnind/inference/tests/test_e2e_inference_clean_api.py::TestE2EInferenceCleanAPI::test_compute_image_metrics - AssertionError: assert 'unknown_metric' in {}
FAILED src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_metrics_computation - AssertionError: assert ('mse' in {'mse': nan, 'psnr': nan, 'ms_ssim': nan} and nan == 0.01)
FAILED src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_unknown_metric_handling - AssertionError: assert 'unknown_metric' in {}
FAILED src/rawnind/inference/tests/test_image_metrics.py::TestComputeImageMetrics::test_masking_application - assert nan == 0.25
FAILED src/rawnind/inference/tests/test_model_checkpoint.py::TestModelCheckpoint::test_from_directory_default_metric - KeyError: 'Metric val_msssim not found in training results'
FAILED src/rawnind/inference/tests/test_standard_compressor.py::test_standard_compressor_forward_pass - ImportError: import error in rawnind.libs: No module named 'rawnind.libs'
FAILED src/rawnind/inference/tests/test_standard_compressor.py::test_standard_compressor_invalid_input - NameError: name 'pt_helpers' is not defined
FAILED src/rawnind/tests/acceptance/test_dataset_base_contracts.py::test_random_crops_and_center_crop_shapes - TypeError: ConfigurableDataset.__init__() got an unexpected keyword argument 'num_crops'
FAILED src/rawnind/tests/acceptance/test_dependencies_and_experiments.py::test_experiment_manager_rm_empty - AssertionError: assert ['iter_0.pt', 'iter_1.pt'] == ['iter_1.pt']
  
  At index 0 diff: 'iter_0.pt' != 'iter_1.pt'
  Left contains one more item: 'iter_1.pt'
  
  Full diff:
    [
  +     'iter_0.pt',
        'iter_1.pt',
    ]
FAILED src/rawnind/tests/acceptance/test_inference_engine.py::test_transfer_function_factory_available - TypeError: gamma() got an unexpected keyword argument 'gamma_val'. Did you mean 'gamma_value'?
FAILED src/rawnind/tests/acceptance/test_legacy_cli_removed.py::TestLegacyCliRemoved::test_pyproject_has_no_legacy_console_scripts - AssertionError: pyproject.toml not found at project root
assert False
 +  where False = exists()
 +    where exists = PosixPath('/home/rengo/rawnind_jddc/src/pyproject.toml').exists
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFactoryFunctions::test_create_rgb_training_dataset - ValueError: No images found in the dataset.
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFactoryFunctions::test_create_bayer_training_dataset - ValueError: No images found in the dataset.
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetFactoryFunctions::test_create_self_supervised_dataset - ValueError: Unsupported dataset type: self_supervised
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetConfigurationAndValidation::test_dataset_config_validation - AttributeError: 'DatasetConfig' object has no attribute 'is_valid'
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetPreprocessingAndAugmentation::test_image_cropping_and_masking - assert torch.Size([128, 128]) == (64, 64)
  
  At index 0 diff: 128 != 64
  
  Full diff:
  + torch.Size([128, 128])
  - (
  -     64,
  -     64,
  - )
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetPreprocessingAndAugmentation::test_data_augmentation_pipeline - AssertionError: assert 'augmentation_applied' in {'clean_images': tensor([[[[-0.7129,  0.2458, -0.0777,  ..., -0.0903,  0.4542, -1.3886],\n          [-1.1576,  0.9972,  1.4563,  ...,  0.2117, -1.5041, -0.2659],\n          [-0.6158,  0.6806, -1.2877,  ...,  1.3818,  1.3997,  1.7241],\n          ...,\n          [-0.1383, -1.0180, -0.7101,  ...,  0.6496, -1.8361,  0.4211],\n          [-0.6430, -0.8499,  0.2258,  ..., -0.7469, -0.2044,  0.2312],\n          [ 1.0728,  0.7230,  0.3726,  ..., -0.9305,  0.3935,  0.3816]],\n\n         [[ 0.6035, -0.1386,  0.6081,  ..., -0.9214, -1.1941, -1.3159],\n          [-1.6448,  0.8710, -0.3317,  ..., -1.1957,  1.7033,  1.9635],\n          [-1.3644, -1.6129,  0.4579,  ..., -0.5223,  0.9163, -1.0175],\n          ...,\n          [ 1.3920, -0.8159, -0.8930,  ..., -0.5211,  1.2342,  1.0868],\n          [-0.8764,  0.1989,  0.7375,  ...,  0.5397, -0.6228, -0.2986],\n          [-0.4152,  0.6891, -1.1112,  ...,  0.7532, -0.3255, -1.0447]],\n\n         [[-0.1199, -0.1181,  0.8556,  ..., -0.9710, -0.6924,  1.5239],\n          [ 0.2858, -1.0963,  1.9270,  ...,  0.8383, -0.9227, -1.4735],\n          [ 1.3158, -0.1060, -0.5998,  ...,  1.8025, -1.0431, -0.3444],\n          ...,\n          [-0.8989,  0.1583,  0.6808,  ...,  0.9391,  0.3762, -1.4066],\n          [-1.6817,  0.3740, -0.1986,  ...,  0.0909,  0.6173,  0.7274],\n          [ 0.3417,  1.4109, -0.0292,  ..., -1.4409, -0.3960,  1.7036]]],\n\n\n        [[[-0.1833, -2.9135,  0.1656,  ..., -0.6454,  0.0660, -0.4736],\n          [-0.1296, -0.9693, -0.6853,  ...,  0.7903,  0.4875,  0.0791],\n          [-0.1326, -0.3686,  1.6370,  ...,  0.6098, -1.0386,  0.3993],\n          ...,\n          [ 0.2214,  0.3591,  0.6764,  ...,  0.1227, -0.2508, -0.5487],\n          [ 0.0385,  0.5523, -1.0788,  ..., -0.6019,  1.6996, -0.8534],\n          [-1.3181,  1.5739, -1.3077,  ...,  0.3208,  0.1169, -0.2033]],\n\n         [[ 0.2084,  0.1450,  0.3486,  ..., -0.2796, -1.1083, -0.2066],\n          [-0.5015,  0.6878, -0.0497,  ...,  0.1606,  1.9677, -0.1602],\n          [ 1.0280,  1.0975, -0.5963,  ..., -0.6152,  0.8720,  0.2601],\n          ...,\n          [-0.6997, -1.0919,  0.7477,  ...,  0.2873,  0.7674, -0.6447],\n          [-0.3534, -0.7819, -1.1325,  ..., -0.2908, -1.4961, -1.0743],\n          [ 0.6052,  1.1910,  0.8472,  ..., -0.8842, -0.9623, -0.8012]],\n\n         [[ 2.1219, -0.1006, -0.8960,  ..., -0.2795, -0.1232,  0.4252],\n          [-1.2225, -0.3828, -0.3562,  ..., -1.5475, -1.6742,  0.8064],\n          [-1.9860,  0.4167,  1.5688,  ...,  0.0378,  0.4979, -2.6908],\n          ...,\n          [ 0.5034,  0.5667, -0.4496,  ...,  0.1440,  0.4193, -0.8014],\n          [ 1.1568, -1.3953, -0.9870,  ...,  0.6175, -0.2178, -0.0835],\n          [-0.1952,  0.0926,  0.7869,  ...,  0.7896, -0.8131, -0.5104]]]]), 'noisy_images': tensor([[[[-0.1621, -0.2231, -1.9301,  ...,  1.3257, -0.8581, -0.7381],\n          [ 0.4815,  0.5847,  0.4977,  ...,  0.5917,  0.3492,  0.0501],\n          [ 2.3290,  0.0356,  0.3886,  ...,  0.1461, -1.1644, -1.4983],\n          ...,\n          [ 1.3258,  0.3065, -1.2087,  ...,  1.3809,  0.9357, -0.0167],\n          [ 0.2691, -0.0500, -0.1337,  ..., -0.0758,  0.0845,  0.2243],\n          [ 0.6031,  1.6380,  2.1497,  ..., -0.3996, -0.6211, -0.1553]],\n\n         [[-0.1559,  0.9479, -0.1337,  ...,  0.0207,  1.6124, -0.9073],\n          [ 1.2550,  1.5088,  0.7727,  ...,  1.4136, -0.3194,  0.8421],\n          [ 0.4392, -1.9287, -0.2302,  ..., -0.3893, -1.6017, -0.3575],\n          ...,\n          [ 0.0804,  1.7633,  2.1168,  ..., -1.6013,  2.1104,  0.6280],\n          [ 0.8526, -1.5754,  0.3242,  ...,  0.6935,  1.6406,  0.4072],\n          [ 0.3569,  0.4179, -0.5538,  ...,  0.0393, -0.8756,  0.6672]],\n\n         [[ 1.3282,  0.0662, -0.0462,  ...,  0.3109, -0.0250,  1.1177],\n          [-1.7696, -0.3168,  0.1907,  ..., -2.6156, -0.7549,  1.4013],\n          [-0.5042,  0.2981, -0.5003,  ..., -3.2161,  1.0966,  0.0872],\n          ...,\n          [ 1.1206,  1.4536, -0.7372,  ..., -0.9398, -0.1173, -0.1236],\n          [-1.8105,  0.4480,  0.9868,  ...,  2.1275,  0.6736,  0.0270],\n          [ 1.2835, -0.3084, -0.5827,  ..., -0.8204,  0.1807,  0.2517]]],\n\n\n        [[[-0.1723,  1.0867,  0.1576,  ..., -1.0232,  0.1826,  0.5089],\n          [ 0.1854,  0.7686,  1.3975,  ..., -1.5855, -0.8917, -0.8627],\n          [ 0.8296,  0.0888, -0.0278,  ..., -0.0690, -1.1090, -1.2240],\n          ...,\n          [ 1.2847,  1.3003, -0.7282,  ..., -0.3706,  0.0827,  2.0501],\n          [ 0.2564,  1.0190, -0.2526,  ..., -1.6271, -0.2248,  0.4163],\n          [ 0.1424, -0.5043, -0.8710,  ..., -0.5437, -0.7351, -0.9515]],\n\n         [[ 0.7374, -0.9858,  2.8755,  ..., -1.4157,  0.8721, -0.5230],\n          [-0.5135,  0.7232,  1.0348,  ...,  2.0635,  0.2419,  0.2568],\n          [ 0.3316, -0.8936,  1.0827,  ...,  1.1137, -1.3464, -0.0469],\n          ...,\n          [ 1.7628,  1.5134,  2.3856,  ...,  0.6202, -0.0249, -0.4983],\n          [-0.8993, -0.6155, -1.0063,  ...,  1.4731, -0.3706, -0.5400],\n          [-0.4060, -1.4850, -1.8824,  ..., -1.2185, -1.4789, -1.6447]],\n\n         [[-0.9140, -0.7328, -2.9411,  ..., -1.0703, -0.4026,  1.2339],\n          [ 0.8134, -0.2188,  1.4912,  ..., -2.0031,  0.4759,  1.4952],\n          [ 1.4627,  0.6942,  1.5292,  ..., -0.8569, -0.4530,  1.6277],\n          ...,\n          [ 0.8513,  0.1672, -0.0948,  ...,  0.8611,  0.5712,  1.3205],\n          [-0.1740,  0.5620, -0.4994,  ...,  1.1879,  0.1404,  0.6662],\n          [ 0.2439, -0.5529, -0.5102,  ...,  0.9389, -0.0113,  0.2261]]]]), 'masks': tensor([[[[1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          ...,\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.]],\n\n         [[1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          ...,\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.]],\n\n         [[1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          ...,\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.]]],\n\n\n        [[[1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          ...,\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.]],\n\n         [[1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          ...,\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.]],\n\n         [[1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          ...,\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.],\n          [1., 1., 1.,  ..., 1., 1., 1.]]]]), 'image_paths': ['aug_test_0.jpg'], 'color_profile_info': {'input': 'lin_rec2020', 'output': 'lin_rec2020', 'conversion_applied': False}, 'preprocessing_info': {'steps_applied': [], 'output_color_space': 'lin_rec2020'}}
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetSplitsAndReservedData::test_test_reserve_enforcement - AssertionError: assert 'reserved_001.jpg' not in {'reserved_001.jpg', 'train_004.jpg', 'train_001.jpg', 'train_002.jpg', 'train_003.jpg', 'reserved_002.jpg'}
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetIntegrationWithTraining::test_dataset_trainer_integration - ValueError: No images found in the dataset.
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetIntegrationWithTraining::test_dataset_preprocessing_pipeline - assert tensor(254.9887) <= 1.0
 +  where tensor(254.9887) = <built-in method max of Tensor object at 0x71436116fca0>()
 +    where <built-in method max of Tensor object at 0x71436116fca0> = tensor([[[[ 81.2326,  75.9974, 206.3128,  ..., 203.7768, 205.2350,  28.1696],\n          [106.4325,  82.1847,   1.4862,  ..., 146.3135, 207.2191,  66.6263],\n          [ 74.8896,  45.2073,  91.2110,  ..., 101.4455, 143.0891, 169.2626],\n          ...,\n          [207.1423, 163.0687,  57.9822,  ...,  43.0672, 129.5308,   2.4318],\n          [142.7770, 150.0392,  20.7966,  ...,   3.7571, 153.2233, 188.4093],\n          [ 53.2710,  33.4529,  17.7739,  ...,  18.5585, 137.6920, 195.9562]],\n\n         [[253.8066, 149.8003,   0.6970,  ...,  94.2188, 124.8096, 240.5291],\n          [141.7290,  57.3588, 188.7869,  ..., 246.9085, 171.9844,  84.5824],\n          [246.4609, 114.3749, 227.2407,  ..., 180.9481,  52.9909, 227.7520],\n          ...,\n          [241.8055, 248.0842, 172.0318,  ..., 240.4253, 100.4672,  22.3540],\n          [230.9609, 105.2749, 244.4480,  ..., 118.5400, 210.5856, 118.2209],\n          [ 61.6609,  11.5450, 227.9087,  ...,  34.2513, 127.9272, 184.7901]],\n\n         [[159.8424, 243.1508, 228.5581,  ...,  48.5607, 233.7365,  10.5129],\n          [106.0982,   7.4019, 235.2607,  ..., 202.8760, 120.4080, 181.4242],\n          [ 88.4553,  26.0058, 139.6701,  ..., 148.3065,  96.3310, 169.3710],\n          ...,\n          [ 58.1835, 151.3195, 127.0525,  ...,   8.8322, 141.9774, 147.6120],\n          [245.2274, 198.6302, 193.7130,  ...,  62.7768, 249.5439,  93.3865],\n          [ 19.2634,  11.5728,   3.5337,  ...,  16.0047,  17.2166, 208.1689]]]]).max
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetValidationDataLoaders::test_create_validation_dataset - ValueError: No images found in the dataset.
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetValidationDataLoaders::test_create_test_dataset - ValueError: No images found in the dataset.
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetCachingAndPerformance::test_dataset_caching_behavior - assert 0 > 0
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetUtilitiesAndHelpers::test_dataset_format_conversion - TypeError: DatasetConfig.__init__() missing 2 required positional arguments: 'num_crops_per_image' and 'batch_size'
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetUtilitiesAndHelpers::test_dataset_subset_creation - ValueError: No images found in the dataset.
FAILED src/rawnind/tests/test_e2e_dataset_clean_api.py::TestDatasetQualityAssurance::test_image_quality_validation - assert 0 == 3
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_vs_legacy_comparison - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_memory_efficiency - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_batch_processing_real - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanImageProcessingPipelineE2E::test_clean_api_error_handling - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiRealWorldUsage::test_clean_api_full_inference_pipeline - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiZeroCLIDependencies::test_no_cli_imports_in_clean_api - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiZeroCLIDependencies::test_programmatic_instantiation_only - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_image_processing_pipeline_clean.py::TestCleanApiZeroCLIDependencies::test_no_file_side_effects - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_create_rgb_denoiser_basic - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_create_bayer_denoiser_basic - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_create_compressor_basic - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_rgb_denoising_inference - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_bayer_denoising_inference - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_batch_inference - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_compute_image_metrics_standalone - AssertionError: assert 'msssim' in {'mse': 0.010061399079859257}
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_model_architecture_options - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceAPI::test_device_handling - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_rgb_end_to_end_pipeline - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_bayer_end_to_end_pipeline - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_compression_end_to_end_pipeline - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceE2EPipeline::test_file_based_processing_pipeline - ModuleNotFoundError: No module named 'rawnind.dependencies.utilities'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceConfiguration::test_custom_model_parameters - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceConfiguration::test_bayer_specific_options - TypeError: InferenceConfig.__init__() got an unexpected keyword argument 'color_correction_matrix'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceConfiguration::test_metrics_configuration - AssertionError: assert 2 == 3
 +  where 2 = len({'mse': 0.009951543062925339, 'psnr': 20.021095275878906})
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceIntegration::test_model_comparison_workflow - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceIntegration::test_memory_efficient_processing - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_architecture_error - AssertionError: Regex pattern did not match.
 Regex: 'Unknown architecture'
 Input: "Unsupported architecture: nonexistent_arch. Supported: ['unet', 'utnet3', 'identity', 'bm3d', 'ManyPriors', 'DenoiseThenCompress', 'JPEGXL', 'JPEG', 'Passthrough', 'standard', 'autoencoder']"
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_image_shape_error - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_inference_clean_api.py::TestCleanInferenceErrorHandling::test_invalid_metrics_error - Failed: DID NOT RAISE <class 'ValueError'>
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingFactoryFunctions::test_create_denoiser_trainer_rgb - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingFactoryFunctions::test_create_denoiser_trainer_bayer - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestCleanTrainingWorkflow::test_training_workflow_rgb_denoiser - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestCleanTrainingWorkflow::test_training_workflow_bayer_denoiser - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestModelCheckpointingAndResumption::test_save_and_load_checkpoint - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestModelCheckpointingAndResumption::test_resume_training_from_checkpoint - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestExperimentManagement::test_experiment_manager_basic_functionality - TypeError: unhashable type: 'dict'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestExperimentManagement::test_experiment_cleanup - TypeError: unhashable type: 'dict'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingDataIntegration::test_training_with_real_dataset_interface - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingValidationAndTesting::test_standalone_validation - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingValidationAndTesting::test_custom_test_evaluation - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestHyperparameterManagement::test_learning_rate_scheduling - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestHyperparameterManagement::test_early_stopping - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingMetrics::test_loss_computation - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingMetrics::test_metrics_computation_during_training - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestBayerSpecificTraining::test_bayer_training_with_demosaicing - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestBayerSpecificTraining::test_bayer_color_matrix_handling - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingModelArchitectures::test_unet_architecture_training - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestMultiDeviceTraining::test_cpu_training - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingOutputSaving::test_save_training_visualizations - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/tests/test_e2e_training_clean_api.py::TestTrainingOutputSaving::test_save_validation_outputs - PermissionError: [Errno 13] Permission denied: '../../models'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_rgb_valid - AttributeError: 'CleanDenoiserTrainer' object has no attribute 'demosaic_fn'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_bayer_valid - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_rgb_invalid_channels - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_init_bayer_invalid_channels - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_process_bayer_output[4-True-expected_camrgb_call_shape0] - AttributeError: <module 'rawnind.dependencies.raw_processing' from '/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py'> does not have the attribute 'demosaic'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_process_bayer_output[3-False-expected_camrgb_call_shape1] - AttributeError: <module 'rawnind.dependencies.raw_processing' from '/home/rengo/rawnind_jddc/src/rawnind/dependencies/raw_processing.py'> does not have the attribute 'demosaic'
FAILED src/rawnind/training/tests/test_clean_denoiser_trainer.py::TestCleanDenoiserTrainer::test_process_bayer_output_unsupported_channels - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_record_metrics_loss_improvement - TypeError: unhashable type: 'dict'
FAILED src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_record_metrics_psnr_improvement - TypeError: unhashable type: 'dict'
FAILED src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_get_best_steps - TypeError: unhashable type: 'dict'
FAILED src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_cleanup_checkpoints - AssertionError: assert 2 == 4
 +  where 2 = <MagicMock name='unlink' id='124534234782016'>.call_count
FAILED src/rawnind/training/tests/test_clean_experiment_manager.py::TestCleanExperimentManager::test_cleanup_checkpoints_not_enough_best - AssertionError: assert 2 == 4
 +  where 2 = <MagicMock name='unlink' id='124534234777984'>.call_count
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_model_rgb - AssertionError: Expected 'create_rgb_denoiser' to be called once. Called 2 times.
Calls: [call(architecture='unet', device='cpu', filter_units=48),
 call().model.to(device(type='cpu')),
 call().model.parameters(),
 call(architecture='unet', device='cpu', filter_units=48),
 call().model.to(device(type='cpu'))].
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_model_bayer - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_loss_function[mse-MSE_loss] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'loss_function'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_loss_function[ms_ssim-MS_SSIM_loss] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'loss_function'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_create_loss_function[l1-L1Loss] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'loss_function'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-False-1] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[False-False-1] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-True-2] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-True-1] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_compute_loss_masking_and_bayer_interpolation[True-True-0.5] - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'input_channels'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_update_learning_rate_decay - TypeError: rawnind.training.clean_api.TrainingConfig() got multiple values for keyword argument 'patience'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_prepare_datasets_mock_fallback[True] - AttributeError: <module 'rawnind.training.clean_api' from '/home/rengo/rawnind_jddc/src/rawnind/training/clean_api.py'> does not have the attribute 'create_training_datasets'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_prepare_datasets_mock_fallback[False] - AttributeError: <module 'rawnind.training.clean_api' from '/home/rengo/rawnind_jddc/src/rawnind/training/clean_api.py'> does not have the attribute 'create_training_datasets'
FAILED src/rawnind/training/tests/test_clean_trainer.py::TestCleanTrainer::test_validate_and_test_flow - TypeError: expected Tensor as element 0 in argument 0, but got MagicMock
FAILED src/rawnind/training/tests/test_training_config.py::TestTrainingConfig::test_create_training_config_from_yaml - AssertionError: assert '5e-5' == 5e-05
 +  where '5e-5' = TrainingConfig(model_architecture='utnet3', architecture='utnet3', arch='utnet3', input_channels=4, in_channels=4, output_channels=3, out_channels=3, learning_rate='5e-5', batch_size=2, crop_size=256, total_steps=5000, validation_interval=250, tot_steps=5000, val_interval=250, loss_function='ms_ssim', loss='ms_ssim', device='cuda', patience=2000, lr_decay_factor=0.2, early_stopping_patience=None, lr_multiplier=None, additional_metrics=[], metrics=[], filter_units=32, funit=32, compression_lambda=None, bit_estimator_lr_multiplier=1.0, hidden_out_channels=None, bitstream_out_channels=None, arch_enc=None, arch_dec=None, preupsample=None, enable_preupsampling=None, test_interval=None, test_crop_size=256, val_crop_size=256, num_crops_per_image=1, save_training_images=False, test_only=False, save_dpath=None, load_path=None).learning_rate
ERROR src/rawnind/dataset/tests/test_datasets_load_time.py::test_measure_train_images_load_time
ERROR src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_init
ERROR src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_compress_and_denoise[input_shape0-expected_output_shape0]
ERROR src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_compress_and_denoise[input_shape1-expected_output_shape1]
ERROR src/rawnind/inference/tests/test_clean_compressor.py::TestCleanCompressor::test_compress_alias
ERROR src/rawnind/inference/tests/test_ext_raw_denoise.py::test_ext_raw_denoise
ERROR src/rawnind/inference/tests/test_playraw.py::test_playraw
ERROR src/rawnind/inference/tests/test_pytorch_integration.py::test_model_device_placement
ERROR src/rawnind/inference/tests/test_pytorch_integration.py::test_model_forward_pass
ERROR src/rawnind/inference/tests/test_pytorch_integration.py::test_model_inference_method
ERROR src/rawnind/inference/tests/test_pytorch_integration.py::test_batch_handling
ERROR src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_rgb_denoiser_training_e2e - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_bayer_denoiser_training_e2e - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_ms_ssim_crop_size_validation - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_denoise_compress_training_e2e - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_api_e2e_training.py::TestE2ETrainingCleanAPI::test_clean_trainer_checkpoint_security - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_init_valid - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_init_missing_compression_lambda - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_create_optimizer_multiple_param_groups - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_compute_loss_with_bpp - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_compute_loss_without_bpp - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_get_optimizer_param_groups - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_clean_denoise_compress_trainer.py::TestCleanDenoiseCompressTrainer::test_compute_joint_loss - AttributeError: Mock object has no attribute 'get_parameters'. Did you mean: 'get_parameter'?
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-bayer-dc]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-bayer-denoise]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-prgb-dc]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[le-prgb-denoise]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-bayer-dc]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-bayer-denoise]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-prgb-dc]
ERROR src/rawnind/training/tests/test_progressive_rawnind.py::test_progressive_rawnind[ge-prgb-denoise]
ERROR src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DCTrainingBayerToProfiledRGB] - TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'init_step'
ERROR src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DCTrainingProfiledRGBToProfiledRGB] - TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'init_step'
ERROR src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DenoiserTrainingBayerToProfiledRGB] - TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'init_step'
ERROR src/rawnind/training/tests/test_validate_and_test.py::test_validate_and_test[DenoiserTrainingProfiledRGBToProfiledRGB] - TypeError: TrainingConfig.__init__() got an unexpected keyword argument 'init_step'
====== 119 failed, 287 passed, 24 skipped, 7 warnings, 35 errors in 4.11s ======
